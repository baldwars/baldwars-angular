<div style="width: 90%; margin-right: auto; margin-left: auto; margin-bottom: 50px;" fxLayout="column">
  <div style="margin-top: 2em;" fxLayout="column" fxLayoutGap="20px">
    <div fxLayout="row" fxLayoutGap="20px">
      <mat-card *ngIf="!isLoading else loader" fxFlex="50">
        <mat-card-title-group fxLayout="row">
          <mat-card-title>
            <fa-icon [icon]="userIcon"></fa-icon> {{ currentUser?.username | titlecase}}
          </mat-card-title>
          <h2 style="font-weight: bold;">Level: {{ currentUser?.level }}</h2>
        </mat-card-title-group>
        <mat-card-content>
          <mat-list>
            <mat-list-item>
              <mat-progress-bar
                color="accent"
                *ngIf="currentUser != null" mode="determinate"
                [value]="currentUser.xp * 100 / currentUser.maxXp"
                (mouseover)="displayXpProgress()"
                [matTooltip]="progressTooltip" matTooltipPosition="right">
                <span>{{ currentUser.xp * 100 / currentUser.maxXp }}%</span>
              </mat-progress-bar>
            </mat-list-item>
            <div matSubheader></div>
            <div fxLayout="row" fxLayoutAlign="space-around center">
              <div>
                <mat-list-item>
                  <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="5px">
                    <div>
                      <span class="skillValue" style="color: green"> {{ victories }} </span>
                    </div>
                    <div>
                      <span style="font-weight: bold"> VICTORIES </span>
                    </div>
                  </div>
                </mat-list-item>
              </div>

              <div>
                <mat-divider [vertical]="true"></mat-divider>
              </div>

              <div>
                <mat-list-item>
                  <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="5px">
                    <div>
                      <span class="skillValue" style="color: blue"> {{ draws }} </span>
                    </div>
                    <div>
                      <span style="font-weight: bold"> DRAWS </span>
                    </div>
                  </div>
                </mat-list-item>
              </div>

              <div>
                <mat-divider [vertical]="true"></mat-divider>
              </div>

              <div>
                <mat-list-item>
                  <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="5px">
                    <div>
                      <span class="skillValue" style="color: red"> {{ defeats }} </span>
                    </div>
                    <div>
                      <span style="font-weight: bold"> DEFEATS </span>
                    </div>
                  </div>
                </mat-list-item>
              </div>
            </div>
          </mat-list>
        </mat-card-content>
      </mat-card>

      <mat-card *ngIf="!isLoading else loader" fxFlex="50">
        <mat-card-title-group>
          <mat-card-title>
            <fa-icon [icon]="warriorIcon"></fa-icon> {{ warrior?.name | titlecase}}
          </mat-card-title>
          <h2 style="font-weight: bold;">Skill Points: {{ warrior?.skillPoints }}</h2>
        </mat-card-title-group>

        <mat-card-content style="margin-top: 2em;">
          <mat-list style="margin-top: 3em; margin-left: 4em;" fxLayout="row" fxLayoutGap="20px">
            <mat-list-item>
              <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px">
                <div [ngClass]="warrior?.skillPoints === 0 ? 'plusSkillDisabled' : 'plusSkill'">
                  <fa-icon [icon]="plusIcon" (click)="skillUp('health')"></fa-icon>
                </div>
                <div style="color: red;">
                  <span fxLayoutGap="20px">
                  <fa-icon [icon]="healthPointsIcon" size="2x"></fa-icon>
                  <span class="skillValue">{{ warrior?.health }}</span>
                </span>
                </div>
              </div>
            </mat-list-item>

            <mat-list-item>
              <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px">
                <div [ngClass]="warrior?.skillPoints === 0 ? 'plusSkillDisabled' : 'plusSkill'">
                  <fa-icon [icon]="plusIcon" (click)="skillUp('actions')"></fa-icon>
                </div>
                <div style="color: darkorange;">
                  <span fxLayoutGap="20px">
                  <fa-icon [icon]="actionPointsIcon" size="2x"></fa-icon>
                  <span class="skillValue">{{ warrior?.actions }}</span>
                </span>
                </div>
              </div>
            </mat-list-item>

            <mat-list-item>
              <div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px">
                <div [ngClass]="warrior?.skillPoints === 0 ? 'plusSkillDisabled' : 'plusSkill'">
                  <fa-icon [icon]="plusIcon" (click)="skillUp('moves')"></fa-icon>
                </div>
                <div style="color: darkgreen;">
                  <span fxLayoutGap="20px">
                  <fa-icon [icon]="movePointsIcon" size="2x"></fa-icon>
                  <span class="skillValue">{{ warrior?.moves }}</span>
                </span>
                </div>
              </div>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>

    <div fxLayout="row" fxLayoutGap="20px">
      <mat-card *ngIf="!isLoading else loader" fxFlex="50">
        <mat-card-title>
          <fa-icon [icon]="weaponsIcon"></fa-icon> Weapons
        </mat-card-title>
        <mat-card-content class="customCardContent">
          <mat-list *ngFor="let weapon of weapons">
            <mat-list-item>
              <button mat-button (click)="openDialog(weapon.name, weapon.level, weapon.damage, weapon.cost, weapon.minRange, weapon.maxRange)">
                Name : {{ weapon.name }}
              </button>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>

      <mat-card *ngIf="!isLoading else loader" fxFlex="50" style="height: 200px;">
        <mat-card-title>
          <fa-icon [icon]="terminalIcon"></fa-icon> Scripts
        </mat-card-title>

        <mat-card-content>
          <div fxLayout="row" fxLayoutAlign="center center" style="margin-top: 2.5em;">
            <mat-list *ngFor="let script of scripts">
              <mat-list-item>
                  <mat-card  class="scripts" (dblclick)="editScript(script)">
                    <mat-card-content>
                      <div fxLayout="column" fxLayoutAlign="center center">
                        <span><fa-icon [icon]="scriptIcon" size="3x"></fa-icon></span>
                        <span>{{script.name}}</span>
                      </div>
                    </mat-card-content>
                  </mat-card>
              </mat-list-item>
            </mat-list>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <mat-card style="padding-bottom: 2.5em;">
      <mat-card-header>
        <mat-card-title>
          <fa-icon [icon]="fightsIcon" size="2x"></fa-icon> Fights History
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div fxLayout="row" fxLayoutAlign="start center" style="margin-top: 2.5em;">
          <mat-list *ngFor="let fight of displayedFights">
            <mat-list-item>
              <mat-card [ngStyle]="{ 'background': fight.color }">
                <mat-card-content>
                  <div fxLayout="row" fxLayoutAlign="center center">
                  <span>{{ fight.striker.warrior.name | titlecase }}
                    <span style="font-size: 14px; font-weight: bold;">VS</span>
                    {{ fight.defender.warrior.name | titlecase }}</span>
                  </div>
                </mat-card-content>
              </mat-card>
            </mat-list-item>
          </mat-list>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<ng-template #loader>
  <mat-progress-spinner mode="indeterminate" color="accent"></mat-progress-spinner>
</ng-template>


